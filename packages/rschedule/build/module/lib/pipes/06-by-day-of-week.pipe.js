import { PipeRule } from './interfaces';
import { Utils } from '../utilities';
import sortedUniq from 'lodash.sorteduniq';
export class ByDayOfWeekPipe extends PipeRule {
    constructor() {
        super(...arguments);
        // used to speed up some operations below;
        this.cachedValidMonthDays = ['', []];
        this.cachedValidYearDays = [0, []];
        // for `monthlyExpand()` and `weeklyExpand()`, upcomingDays
        // holds an array of dates within the current month that are valid
        //
        // for `yearlyExpand()`, upcomingDays holds an array of numbers,
        // each number is equal to the number of days from the start of
        // the year that a valid date exists on. i.e. set a
        // date to January 1st and then add days to the date equal to
        // one of the numbers in the array and you'll be on a valid date.
        this.upcomingDays = [];
    }
    run(args) {
        if (args.invalidDate)
            return this.nextPipe.run(args);
        if (this.options.frequency === 'MONTHLY') {
            return this.options.byDayOfMonth !== undefined
                ? this.monthlyFilter(args)
                : this.monthlyExpand(args);
        }
        else if (this.options.frequency === 'YEARLY') {
            if (this.options.byMonthOfYear !== undefined && this.options.byDayOfMonth !== undefined)
                return this.monthlyFilter(args);
            else if (this.options.byMonthOfYear !== undefined)
                return this.monthlyExpand(args);
            else if (this.options.byDayOfMonth !== undefined) {
                return this.yearlyFilter(args);
            }
            else
                return this.yearlyExpand(args);
        }
        else {
            return this.options.frequency === 'WEEKLY' ? this.weeklyExpand(args) : this.simpleFilter(args);
        }
    }
    yearlyExpand(args) {
        const date = args.date;
        if (this.upcomingDays.length === 0) {
            if (this.cachedValidYearDays[0] !== date.get('year')) {
                this.cachedValidYearDays = [date.get('year'), getValidYearDays(date, this.options)];
            }
            this.upcomingDays = this.cachedValidYearDays[1];
            if (this.upcomingDays.length === 0) {
                return this.nextPipe.run({ date, invalidDate: true });
            }
            this.expandingPipes.push(this);
        }
        else {
            if (this.options.byHourOfDay)
                date.set('hour', 0);
            if (this.options.byMinuteOfHour)
                date.set('minute', 0);
            if (this.options.bySecondOfMinute)
                date.set('second', 0);
        }
        let nextDay = this.upcomingDays.shift();
        Utils.setDateToStartOfYear(date).add(nextDay - 1, 'day');
        if (this.upcomingDays.length === 0)
            this.expandingPipes.pop();
        return this.nextPipe.run({ date });
    }
    monthlyExpand(args) {
        const date = args.date;
        if (this.upcomingDays.length === 0) {
            if (this.cachedValidMonthDays[0] !== `${date.get('year')}-${date.get('month')}`) {
                this.cachedValidMonthDays = [
                    `${date.get('year')}-${date.get('month')}`,
                    getValidMonthDays(date, this.options),
                ];
            }
            this.upcomingDays = this.cachedValidMonthDays[1];
            if (this.upcomingDays.length === 0) {
                return this.nextPipe.run({ date, invalidDate: true });
            }
            this.expandingPipes.push(this);
        }
        else {
            if (this.options.byHourOfDay)
                date.set('hour', 0);
            if (this.options.byMinuteOfHour)
                date.set('minute', 0);
            if (this.options.bySecondOfMinute)
                date.set('second', 0);
        }
        let nextDay = this.upcomingDays.shift();
        date.set('day', nextDay);
        if (this.upcomingDays.length === 0)
            this.expandingPipes.pop();
        return this.nextPipe.run({ date });
    }
    weeklyExpand(args) {
        const date = args.date;
        if (this.upcomingDays.length === 0) {
            const orderedWeekdays = Utils.orderedWeekdays(this.options.weekStart);
            const currentDateIndex = orderedWeekdays.indexOf(date.get('weekday'));
            this.upcomingDays = this.options
                .byDayOfWeek // calculate the number of days that need to be added to the current date to
                // get to a valid date
                .map(day => orderedWeekdays.indexOf(day))
                .filter(day => day >= currentDateIndex)
                .sort((a, b) => {
                if (a > b)
                    return 1;
                if (b > a)
                    return -1;
                return 0;
            });
            if (this.upcomingDays.length === 0) {
                return this.nextPipe.run({ date, invalidDate: true });
            }
            this.expandingPipes.push(this);
        }
        else {
            if (this.options.byHourOfDay)
                date.set('hour', 0);
            if (this.options.byMinuteOfHour)
                date.set('minute', 0);
            if (this.options.bySecondOfMinute)
                date.set('second', 0);
        }
        let nextDay = this.upcomingDays.shift();
        Utils.setDateToStartOfWeek(date, this.options.weekStart).add(nextDay, 'day');
        if (this.upcomingDays.length === 0)
            this.expandingPipes.pop();
        return this.nextPipe.run({ date });
    }
    yearlyFilter(args) {
        const nextValidDateThisYear = getNextValidDateThisYear(args.date, this.options, this.cachedValidYearDays);
        const validDay = nextValidDateThisYear
            ? args.date.get('day') === nextValidDateThisYear.get('day')
            : false;
        if (validDay)
            return this.nextPipe.run({ date: args.date });
        const newDate = this.cloneDateWithGranularity(args.date, 'year').add(1, 'year');
        const next = nextValidDateThisYear
            ? nextValidDateThisYear
            : getNextValidDateThisYear(newDate, this.options, this.cachedValidYearDays);
        return this.nextPipe.run({
            invalidDate: true,
            date: args.date,
            skipToIntervalOnOrAfter: next,
        });
    }
    monthlyFilter(args) {
        const nextValidDateThisMonth = getNextValidDateThisMonth(this.cloneDateWithGranularity(args.date, 'day'), this.options, this.cachedValidMonthDays);
        const validDay = nextValidDateThisMonth
            ? args.date.get('day') === nextValidDateThisMonth.get('day')
            : false;
        if (validDay)
            return this.nextPipe.run({ date: args.date });
        const next = nextValidDateThisMonth
            ? nextValidDateThisMonth
            : getNextValidDateThisMonth(this.cloneDateWithGranularity(args.date, 'month').add(1, 'month'), this.options, this.cachedValidMonthDays);
        return this.nextPipe.run({
            invalidDate: true,
            date: args.date,
            skipToIntervalOnOrAfter: next,
        });
    }
    simpleFilter(args) {
        const validWeekdays = Utils.orderedWeekdays(this.options.weekStart).filter(day => this.options.byDayOfWeek.includes(day));
        const validDay = validWeekdays.includes(args.date.get('weekday'));
        if (validDay)
            return this.nextPipe.run({ date: args.date });
        // if the current date does not pass this filter,
        // is it possible for a date to pass this filter for the remainder of the week?
        //
        // - We know the current `options.frequency` is not yearly or monthly or weekly
        const upcomingWeekdays = Utils.weekdays.slice(Utils.weekdays.indexOf(args.date.get('weekday')));
        const validUpcomingWeekday = validWeekdays.filter(day => upcomingWeekdays.includes(day))[0];
        const weekday = validUpcomingWeekday ? validUpcomingWeekday : validWeekdays[0];
        const next = this.cloneDateWithGranularity(args.date, 'day');
        const days = differenceInDaysBetweenTwoWeekdays(args.date.get('weekday'), weekday);
        next.add(days, 'day');
        return this.nextPipe.run({
            invalidDate: true,
            date: args.date,
            skipToIntervalOnOrAfter: next,
        });
    }
}
function differenceInDaysBetweenTwoWeekdays(a, b) {
    const result = Utils.weekdays.indexOf(a) - Utils.weekdays.indexOf(b);
    return result > 0 ? 7 - result : Math.abs(result);
}
function getNextValidDateThisYear(date, options, validYearDaysCache) {
    if (validYearDaysCache[0] !== date.get('year')) {
        validYearDaysCache = [date.get('year'), getValidYearDays(date, options)];
    }
    date = date
        .clone()
        .set('hour', 0)
        .set('minute', 0)
        .set('second', 0);
    const currentYearDay = date.get('yearday');
    const dayNumber = validYearDaysCache[1].find(dayNumber => dayNumber >= currentYearDay);
    if (dayNumber)
        return Utils.setDateToStartOfYear(date).add(dayNumber - 1, 'day');
    else
        return null;
}
function getValidYearDays(date, options) {
    const weekdays = [];
    const specificWeekdays = [];
    let hasPositiveWeekdays = false;
    let hasNegativeWeekdays = false;
    const validDates = [];
    options.byDayOfWeek.forEach(day => {
        if (!Array.isArray(day))
            weekdays.push(day);
        else {
            specificWeekdays.push(day);
            day[1] > 0 ? (hasPositiveWeekdays = true) : (hasNegativeWeekdays = true);
        }
    });
    const firstWeekdays = {};
    const lastWeekdays = {};
    const lastDayOfYear = Utils.getDaysInYear(date.get('year'));
    if (hasPositiveWeekdays || weekdays.length > 0) {
        const startingDate = Utils.setDateToStartOfYear(date.clone());
        firstWeekdays[startingDate.get('weekday')] = 1;
        firstWeekdays[startingDate.add(1, 'day').get('weekday')] = 2;
        firstWeekdays[startingDate.add(1, 'day').get('weekday')] = 3;
        firstWeekdays[startingDate.add(1, 'day').get('weekday')] = 4;
        firstWeekdays[startingDate.add(1, 'day').get('weekday')] = 5;
        firstWeekdays[startingDate.add(1, 'day').get('weekday')] = 6;
        firstWeekdays[startingDate.add(1, 'day').get('weekday')] = 7;
    }
    if (hasNegativeWeekdays) {
        const endingDate = Utils.setDateToEndOfYear(date.clone());
        lastWeekdays[endingDate.get('weekday')] = lastDayOfYear;
        lastWeekdays[endingDate.subtract(1, 'day').get('weekday')] = lastDayOfYear - 1;
        lastWeekdays[endingDate.subtract(1, 'day').get('weekday')] = lastDayOfYear - 2;
        lastWeekdays[endingDate.subtract(1, 'day').get('weekday')] = lastDayOfYear - 3;
        lastWeekdays[endingDate.subtract(1, 'day').get('weekday')] = lastDayOfYear - 4;
        lastWeekdays[endingDate.subtract(1, 'day').get('weekday')] = lastDayOfYear - 5;
        lastWeekdays[endingDate.subtract(1, 'day').get('weekday')] = lastDayOfYear - 6;
    }
    for (const weekday of specificWeekdays) {
        let nextYearDay;
        if (weekday[1] < 0) {
            nextYearDay = lastWeekdays[weekday[0]] + (weekday[1] + 1) * 7;
        }
        else {
            nextYearDay = firstWeekdays[weekday[0]] + (weekday[1] - 1) * 7;
        }
        if (nextYearDay > lastDayOfYear || nextYearDay < 0) {
            continue;
        }
        validDates.push(nextYearDay);
    }
    for (const weekday of weekdays) {
        let nextYearDay = firstWeekdays[weekday];
        while (nextYearDay <= lastDayOfYear) {
            validDates.push(nextYearDay);
            nextYearDay = nextYearDay + 7;
        }
    }
    return sortedUniq(validDates
        .sort((a, b) => {
        if (a > b)
            return 1;
        else if (b > a)
            return -1;
        else
            return 0;
    })
        .filter(yearday => date.get('yearday') <= yearday));
}
function getNextValidDateThisMonth(date, options, validMonthDaysCache) {
    if (validMonthDaysCache[0] !== `${date.get('year')}-${date.get('month')}`) {
        validMonthDaysCache = [
            `${date.get('year')}-${date.get('month')}`,
            getValidMonthDays(date, options),
        ];
    }
    date = date
        .clone()
        .set('hour', 0)
        .set('minute', 0)
        .set('second', 0);
    const currentDay = date.get('day');
    const day = validMonthDaysCache[1].find(day => day >= currentDay);
    if (day)
        return date.set('day', day);
    else
        return null;
}
function getValidMonthDays(date, options) {
    const weekdays = [];
    const specificWeekdays = [];
    let hasPositiveWeekdays = false;
    let hasNegativeWeekdays = false;
    const validDates = [];
    options.byDayOfWeek.forEach(day => {
        if (!Array.isArray(day))
            weekdays.push(day);
        else {
            specificWeekdays.push(day);
            day[1] > 0 ? (hasPositiveWeekdays = true) : (hasNegativeWeekdays = true);
        }
    });
    const firstWeekdays = {};
    const lastWeekdays = {};
    const daysInMonth = Utils.getDaysInMonth(date.get('month'), date.get('year'));
    if (hasPositiveWeekdays || weekdays.length > 0) {
        const startingDate = date.clone().set('day', 1);
        firstWeekdays[startingDate.get('weekday')] = 1;
        firstWeekdays[startingDate.add(1, 'day').get('weekday')] = 2;
        firstWeekdays[startingDate.add(1, 'day').get('weekday')] = 3;
        firstWeekdays[startingDate.add(1, 'day').get('weekday')] = 4;
        firstWeekdays[startingDate.add(1, 'day').get('weekday')] = 5;
        firstWeekdays[startingDate.add(1, 'day').get('weekday')] = 6;
        firstWeekdays[startingDate.add(1, 'day').get('weekday')] = 7;
    }
    if (hasNegativeWeekdays) {
        const endingDate = date.clone().set('day', daysInMonth);
        lastWeekdays[endingDate.get('weekday')] = daysInMonth;
        lastWeekdays[endingDate.subtract(1, 'day').get('weekday')] = daysInMonth - 1;
        lastWeekdays[endingDate.subtract(1, 'day').get('weekday')] = daysInMonth - 2;
        lastWeekdays[endingDate.subtract(1, 'day').get('weekday')] = daysInMonth - 3;
        lastWeekdays[endingDate.subtract(1, 'day').get('weekday')] = daysInMonth - 4;
        lastWeekdays[endingDate.subtract(1, 'day').get('weekday')] = daysInMonth - 5;
        lastWeekdays[endingDate.subtract(1, 'day').get('weekday')] = daysInMonth - 6;
    }
    for (const weekday of specificWeekdays) {
        let nextDay;
        if (weekday[1] < 0) {
            nextDay = lastWeekdays[weekday[0]] + (weekday[1] + 1) * 7;
        }
        else {
            nextDay = firstWeekdays[weekday[0]] + (weekday[1] - 1) * 7;
        }
        if (nextDay > daysInMonth || nextDay < 0) {
            continue;
        }
        validDates.push(nextDay);
    }
    for (const weekday of weekdays) {
        let nextDay = firstWeekdays[weekday];
        while (nextDay <= daysInMonth) {
            validDates.push(nextDay);
            nextDay = nextDay + 7;
        }
    }
    return sortedUniq(validDates
        .sort((a, b) => {
        if (a > b)
            return 1;
        else if (b > a)
            return -1;
        else
            return 0;
    })
        .filter(monthday => date.get('day') <= monthday));
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMDYtYnktZGF5LW9mLXdlZWsucGlwZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9saWIvcGlwZXMvMDYtYnktZGF5LW9mLXdlZWsucGlwZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLEVBQUUsUUFBUSxFQUF5QixNQUFNLGNBQWMsQ0FBQTtBQUU5RCxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sY0FBYyxDQUFBO0FBQ3BDLE9BQU8sVUFBVSxNQUFNLG1CQUFtQixDQUFBO0FBRTFDLE1BQU0sc0JBQWlELFNBQVEsUUFBVztJQUExRTs7UUFvQkUsMENBQTBDO1FBQ2xDLHlCQUFvQixHQUF1QixDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQTtRQUNuRCx3QkFBbUIsR0FBdUIsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUE7UUFFekQsMkRBQTJEO1FBQzNELGtFQUFrRTtRQUNsRSxFQUFFO1FBQ0YsZ0VBQWdFO1FBQ2hFLCtEQUErRDtRQUMvRCxtREFBbUQ7UUFDbkQsNkRBQTZEO1FBQzdELGlFQUFpRTtRQUN6RCxpQkFBWSxHQUFhLEVBQUUsQ0FBQTtJQTJMckMsQ0FBQztJQTFOQyxHQUFHLENBQUMsSUFBbUI7UUFDckIsSUFBSSxJQUFJLENBQUMsV0FBVztZQUFFLE9BQU8sSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUE7UUFFcEQsSUFBSSxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVMsS0FBSyxTQUFTLEVBQUU7WUFDeEMsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLFlBQVksS0FBSyxTQUFTO2dCQUM1QyxDQUFDLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUM7Z0JBQzFCLENBQUMsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxDQUFBO1NBQzdCO2FBQU0sSUFBSSxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVMsS0FBSyxR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LEdBQUcsS0FBSyxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxFQUFFLElBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQTtJQUU3RSxJQUFJLG1CQUFtQixJQUFJLFFBQVEsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO1FBQzlDLE1BQU0sWUFBWSxHQUFHLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQyxHQUFHLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFBO1FBRS9DLGFBQWEsQ0FBQyxZQUFZLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFBO1FBQzlDLGFBQWEsQ0FBQyxZQUFZLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxLQUFLLENBQUMsQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUE7UUFDNUQsYUFBYSxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQTtRQUM1RCxhQUFhLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFBO1FBQzVELGFBQWEsQ0FBQyxZQUFZLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxLQUFLLENBQUMsQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUE7UUFDNUQsYUFBYSxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQTtRQUM1RCxhQUFhLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFBO0tBQzdEO0lBRUQsSUFBSSxtQkFBbUIsRUFBRTtRQUN2QixNQUFNLFVBQVUsR0FBRyxJQUFJLENBQUMsS0FBSyxFQUFFLENBQUMsR0FBRyxDQUFDLEtBQUssRUFBRSxXQUFXLENBQUMsQ0FBQTtRQUV2RCxZQUFZLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxHQUFHLFdBQVcsQ0FBQTtRQUNyRCxZQUFZLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDLEdBQUcsV0FBVyxHQUFHLENBQUMsQ0FBQTtRQUM1RSxZQUFZLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDLEdBQUcsV0FBVyxHQUFHLENBQUMsQ0FBQTtRQUM1RSxZQUFZLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDLEdBQUcsV0FBVyxHQUFHLENBQUMsQ0FBQTtRQUM1RSxZQUFZLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDLEdBQUcsV0FBVyxHQUFHLENBQUMsQ0FBQTtRQUM1RSxZQUFZLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDLEdBQUcsV0FBVyxHQUFHLENBQUMsQ0FBQTtRQUM1RSxZQUFZLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDLEdBQUcsV0FBVyxHQUFHLENBQUMsQ0FBQTtLQUM3RTtJQUVELEtBQUssTUFBTSxPQUFPLElBQUksZ0JBQWdCLEVBQUU7UUFDdEMsSUFBSSxPQUFlLENBQUE7UUFFbkIsSUFBSSxPQUFPLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxFQUFFO1lBQ2xCLE9BQU8sR0FBRyxZQUFZLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFBO1NBQzFEO2FBQU07WUFDTCxPQUFPLEdBQUcsYUFBYSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQTtTQUMzRDtRQUVELElBQUksT0FBTyxHQUFHLFdBQVcsSUFBSSxPQUFPLEdBQUcsQ0FBQyxFQUFFO1lBQ3hDLFNBQVE7U0FDVDtRQUVELFVBQVUsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUE7S0FDekI7SUFFRCxLQUFLLE1BQU0sT0FBTyxJQUFJLFFBQVEsRUFBRTtRQUM5QixJQUFJLE9BQU8sR0FBRyxhQUFhLENBQUMsT0FBTyxDQUFDLENBQUE7UUFFcEMsT0FBTyxPQUFPLElBQUksV0FBVyxFQUFFO1lBQzdCLFVBQVUsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUE7WUFDeEIsT0FBTyxHQUFHLE9BQU8sR0FBRyxDQUFDLENBQUE7U0FDdEI7S0FDRjtJQUVELE9BQU8sVUFBVSxDQUNmLFVBQVU7U0FDUCxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUU7UUFDYixJQUFJLENBQUMsR0FBRyxDQUFDO1lBQUUsT0FBTyxDQUFDLENBQUE7YUFDZCxJQUFJLENBQUMsR0FBRyxDQUFDO1lBQUUsT0FBTyxDQUFDLENBQUMsQ0FBQTs7WUFDcEIsT0FBTyxDQUFDLENBQUE7SUFDZixDQUFDLENBQUM7U0FDRCxNQUFNLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxJQUFJLFFBQVEsQ0FBQyxDQUNuRCxDQUFBO0FBQ0gsQ0FBQyJ9